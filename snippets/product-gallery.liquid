{% comment %}
  Product Gallery with Thumbnails
  Main image: variant image → product featured image → first product image.
{% endcomment %}

{% assign current_variant = product.selected_or_first_available_variant %}
{% assign main_image = current_variant.featured_image | default: product.featured_image %}
{% if main_image == blank and product.images.size > 0 %}
  {% assign main_image = product.images[0] %}
{% endif %}
{% assign main_image_src = main_image | image_url: width: 2000 %}
{% assign main_image_alt = main_image.alt | default: product.title | escape %}

<div class="product-gallery-container">
  <!-- Main Image -->
  <div class="product-gallery-main">
    {% if main_image_src != blank %}
    <img 
      id="product-main-image"
      src="{{ main_image_src }}"
      alt="{{ main_image_alt }}"
      class="product-main-image"
      loading="eager">
    {% endif %}
    {% if current_variant.compare_at_price > current_variant.price %}
      <span class="sale-badge">Sale</span>
    {% endif %}
  </div>
  
  <!-- Thumbnails -->
  {% if product.images.size > 1 %}
    <div class="product-gallery-thumbnails">
      {% for image in product.images limit: 5 %}
        <button 
          type="button"
          class="thumbnail-btn {% if forloop.first %}active{% endif %}"
          data-image-src="{{ image | image_url: width: 2000 }}"
          aria-label="View image {{ forloop.index }}">
          <img 
            src="{{ image | image_url: width: 200 }}" 
            alt="{{ image.alt | escape }}"
            loading="lazy">
        </button>
      {% endfor %}
    </div>
  {% endif %}
</div>

